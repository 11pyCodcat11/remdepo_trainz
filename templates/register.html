{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Регистрация</title>
    <link rel="stylesheet" href="{% static 'login.css' %}">
</head>
<body class="register-page">
    <!-- Кнопка Назад -->
    <a href="{% url 'home' %}" class="back-button"><span>Назад к каталогу</span></a>

    <div class="login-wrapper">
        <div class="login-card">
            <h1 class="login-title">Регистрация</h1>
            
            <form class="login-form" method="POST" id="registerForm">
                {% csrf_token %}
                
                <!-- Сообщения выводим сервисным уведомлением через JS -->
                <script type="application/json" id="messages-data">
                    [
                    {% for message in messages %}
                      {"text": "{{ message|escapejs }}", "tags": "{{ message.tags }}"}{% if not forloop.last %},{% endif %}
                    {% endfor %}
                    ]
                </script>
                
                <div class="form-fields">
                    <!-- Логин -->
                    <input type="text" name="username" id="username" class="input-field" placeholder="Логин" required>
                    <div class="error-message" id="usernameError"></div>

                    <input type="email" name="email" id="email" class="input-field" placeholder="Email" required>
                    <div class="error-message" id="emailError"></div>
        
                    
                    <!-- Пароль -->
                    <div class="password-container">
                        <input type="password" name="password" id="password" class="input-field" placeholder="Пароль" required>
                        <button type="button" class="eye-toggle" id="eyeToggle1">
                            <svg viewBox="0 0 24 24"></svg>
                        </button>
                    </div>
                    <div class="error-message" id="passwordError"></div>

                    <!-- Повтор пароля -->
                    <div class="password-container">
                        <input type="password" name="password2" id="password2" class="input-field" placeholder="Повторите пароль" required>
                        <button type="button" class="eye-toggle" id="eyeToggle2">
                            <svg viewBox="0 0 24 24"></svg>
                        </button>
                    </div>
                    <div class="error-message" id="password2Error"></div>
                    
                    <!-- Чекбокс -->
                    <label class="checkbox-label">
                        <input type="checkbox" id="agreeCheckbox" required>
                        <span class="checkbox-text">Я согласен на обработку персональных данных и принимаю 
                        <a href="{% static 'images/User_agrinement.pdf' %}" target="_blank">пользовательское соглашение</a></span>
                    </label>
                    <div class="error-message" id="checkboxError"></div>
                </div>
                
                <!-- Кнопка -->
                <div class="login-btn-container">
                    <button type="submit" class="login-btn">Зарегистрироваться</button>
                </div>
            </form>
            
            <!-- Ссылка -->
            <div class="register-link">
                Уже есть аккаунт? <a href="{% url 'login' %}">Войти</a>
            </div>
        </div>
    </div>

    <script src="{% static 'main.js' %}"></script>
    <script>
        // Показ сервисных сообщений (как на странице входа)
        (function(){
            try {
                const el = document.getElementById('messages-data');
                if (el && el.textContent) {
                    const msgs = JSON.parse(el.textContent || '[]');
                    msgs.forEach(function(m){
                        if (typeof showNotification === 'function') {
                            const type = (m.tags === 'success') ? 'success' : 'error';
                            showNotification(m.text, type, 4000);
                        }
                    });
                }
            } catch(e) {}
        })();
    </script>
    <script src="{% static 'register.js' %}"></script>
</body>
</html>
